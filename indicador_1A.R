# Monitoramento do Plano Nacional de Educação em Nível Municipal

## Introdução

# A busca pela universalização do acesso à educação e da melhoria da qualidade de 
# ensino é uma meta perseguida pela sociedade brasileira há bastante tempo. 
# Nesta direção, o Plano Nacional de Educação (PNE), aprovado pela Lei 13.005/2014, 
# e com vigência entre 2014 e 2024, constitui um marco fundamental nas políticas públicas 
# educacionais brasileiras. O PNE possui 20 metas e conferem ao País um horizonte para 
# o qual os esforços dos entes federativos e da sociedade civil devem convergir 
# com a finalidade de consolidar um sistema educacional capaz de concretizar o 
# direito à educação em sua integralidade, dissolvendo as barreiras para o acesso 
# e a permanência, reduzindo as desigualdades, promovendo os direitos humanos e garantindo 
# a formação para o trabalho e para o exercício autônomo da cidadania (BRASIL, 2014, 2015).
# 
# O PNE possui metas estruturantes, que visam a garantia do direito à educação básica 
# com qualidade, que dizem respeito ao acesso, à universalização da alfabetização e à 
# ampliação da escolaridade e das oportunidades educacionais, metas com vistas à 
# redução das desigualdades e à valorização da diversidade, e metas para a valorização 
# dos profissionais da educação, considerada estratégica para que as metas anteriores 
# sejam atingidas.
# 
# O Ministério da Educação publicou o 1º, 2º e 3º Relatórios referentes aos ciclos de 
# monitoramento das metas do PNE: biênio 2014-2016, 2016-2018 e 2008-2020, 
# exercendo, assim, sua atribuição de publicar, a cada dois anos, estudos para aferir 
# o cumprimento das metas estabelecidas no PNE, conforme determina a Lei nº 13.005/2014. 
# Esta publicação faz parte de um conjunto de ações realizadas pelo Instituto Nacional de 
# Estudos e Pesquisas Educacionais Anísio Teixeira (INEP), voltadas à produção e disseminação 
# de informações e a estudos direcionados a subsidiar o monitoramento 
# do PNE, bem como à formulação, implementação e avaliação de políticas públicas na área 
# da educação.
# 
# Apesar de importantes, os relatórios de monitoramento do INEP consolidam os resultados dos
# estados, por região e nacional, não estando disponívies análise em nível municipal. 
# Diante disso, este trabalho pretende seguir a mesma metodologia utilizado pelo 
# INEP e propor uma metodologia que permita a análise dos indicadores do PNE em nível municipa. 
# Como estudo de caso, pretende-se calcular os indicadores do PNE para a a Microrregião de 
# Itacoatiara, composta pelos municípios de Itacoatiara, Itapiranga, Nova Olinda do Norte, 
# Silves e Urucurituba, que fazem parte da Mesorregião denominada de Centro Amazonense, 
# correspondendo a uma população de 177.387 habitante (IBGE, 2018), baseando-se no que 
# nisto o objetivo geral deste trabalho é Realizar o monitoramento das metas estabelecidas 
# nos Planos Municipais de Educação nos municípios de Itacoatiara, Itapiranga, Nova Olinda do Norte,
# Silves e Urucurituba, que formam a microrregião de Itacoatiara, levando em consideração a 
# importância de conhecer a realidade educacional desta microrregião e apresenta-la para a 
# sociedade. 

# O Painel de Monitoramento do PNE pode ser acessado em:

# <https://www.gov.br/inep/pt-br/acesso-a-informacao/dados-abertos/inep-data/painel-de-monitoramento-do-pne>


# Objetivo Geral: 

#  Calcular a Meta 1 do PNE para a Microrregião de Itacoatiara, como base para o aprendizado
#  que que permita, posteriormente, calcular todas as 20 metas, bem como seus inicadores.

# Meta 1:Universalizar, até 2016, a educação infantil na pré-escola para as crianças de 
# 4 (quatro) a # 5 (cinco) anos de idade e ampliar a oferta de educação infantil em creches 
# de forma a atender, # no mínimo, 50% (cinquenta por cento) das crianças de até 3 (três) anos 
# até o final da vigência # deste PNE.

# Objetivos Especiíficos
# 1) Calcular o indicador 1A: Percentual da população de 4 e 5 anos que frequenta a escola
# 2) Calcular o indicador 1B: Percentual da população de 0 a 3 anos que frequenta a escola

#   Monotoramento do Plano Nacional de Educação em Nível Municipal

## Introdução

# A busca pela universalização do acesso à educação e da melhoria da qualidade de 
# ensino é uma meta perseguida pela sociedade brasileira há bastante tempo. 
# Nesta direção, o Plano Nacional de Educação (PNE), aprovado pela Lei 13.005/2014, 
# e com vigência entre 2014 e 2024, constitui um marco fundamental nas políticas públicas 
# educacionais brasileiras. O PNE possui 20 metas e conferem ao País um horizonte para 
# o qual os esforços dos entes federativos e da sociedade civil devem convergir 
# com a finalidade de consolidar um sistema educacional capaz de concretizar o 
# direito à educação em sua integralidade, dissolvendo as barreiras para o acesso 
# e a permanência, reduzindo as desigualdades, promovendo os direitos humanos e garantindo 
# a formação para o trabalho e para o exercício autônomo da cidadania (BRASIL, 2014, 2015).
# 
# O PNE possui metas estruturantes, que visam a garantia do direito à educação básica 
# com qualidade, que dizem respeito ao acesso, à universalização da alfabetização e à 
# ampliação da escolaridade e das oportunidades educacionais, metas com vistas à 
# redução das desigualdades e à valorização da diversidade, e metas para a valorização 
# dos profissionais da educação, considerada estratégica para que as metas anteriores 
# sejam atingidas.
# 
# O Ministério da Educação publicou o 1º, 2º e 3º Relatórios referentes aos ciclos de 
# monitoramento das metas do PNE: biênio 2014-2016, 2016-2018 e 2008-2020, 
# exercendo, assim, sua atribuição de publicar, a cada dois anos, estudos para aferir 
# o cumprimento das metas estabelecidas no PNE, conforme determina a Lei nº 13.005/2014. 
# Esta publicação faz parte de um conjunto de ações realizadas pelo Instituto Nacional de 
# Estudos e Pesquisas Educacionais Anísio Teixeira (INEP), voltadas à produção e disseminação 
# de informações e a estudos direcionados a subsidiar o monitoramento 
# do PNE, bem como à formulação, implementação e avaliação de políticas públicas na área 
# da educação.
# 
# Apesar de importantes, os relatórios de monitoramento do INEP consolidam os resultados dos
# estados, por região e nacional, não estando disponívies análise em nível municipal. 
# Diante disso, este trabalho pretende seguir a mesma metodologia utilizado pelo 
# INEP e propor uma metodologia que permita a análise dos indicadores do PNE em nível municipa. 
# Como estudo de caso, pretende-se calcular os indicadores do PNE para a a Microrregião de 
# Itacoatiara, composta pelos municípios de Itacoatiara, Itapiranga, Nova Olinda do Norte, 
# Silves e Urucurituba, que fazem parte da Mesorregião denominada de Centro Amazonense, 
# correspondendo a uma população de 177.387 habitante (IBGE, 2018), baseando-se no que 
# nisto o objetivo geral deste trabalho é Realizar o monitoramento das metas estabelecidas 
# nos Planos Municipais de Educação nos municípios de Itacoatiara, Itapiranga, Nova Olinda do Norte,
# Silves e Urucurituba, que formam a microrregião de Itacoatiara, levando em consideração a 
# importância de conhecer a realidade educacional desta microrregião e apresenta-la para a 
# sociedade. 

# O Painel de Monitoramento do PNE pode ser acessado em:

# <https://www.gov.br/inep/pt-br/acesso-a-informacao/dados-abertos/inep-data/painel-de-monitoramento-do-pne>


# Objetivo Geral: 

#  Calcular a Meta 1 do PNE para a Microrregião de Itacoatiara, como base para o aprendizado
#  que que permita, posteriormente, calcular todas as 20 metas, bem como seus inicadores.

# Meta 1:Universalizar, até 2016, a educação infantil na pré-escola para as crianças de 
# 4 (quatro) a # 5 (cinco) anos de idade e ampliar a oferta de educação infantil em creches 
# de forma a atender, # no mínimo, 50% (cinquenta por cento) das crianças de até 3 (três) anos 
# até o final da vigência # deste PNE.

# Objetivos Especiíficos
# 1) Calcular o indicador 1A: Percentual da população de 4 e 5 anos que frequenta a escola
# 2) Calcular o indicador 1B: Percentual da população de 0 a 3 anos que frequenta a escola


# Importação e Tratamento dos Dados

#  A primeira base que ser importada: Projeção da população brasileira: 2010-2060.

# Importante: Esta base contem a estimativa da população brasileira distribuida por
# idade (0 a 90+ anos). Ela será usada para estimar a distribuição das idades nos
# municípios, dado não haver desagregação das idades em nível municipal.

library(tidyverse)
library(readxl)
library(lubridate)
library(plyr)

df_projecoes = read_excel("Dados/popIDADES.xls", skip = 195, n_max = 92)
idades <- df_projecoes[1] # Esta variável será reutilizada posteriormente

# Calculando indices das idades

indices <- df_projecoes # inicializando a variável índice

prev <- NULL  # inicializando o contador
for (prev in 2:length(df_projecoes)) {
  indices[prev] = df_projecoes[prev]/sum(df_projecoes[[prev]])
}

# O próximo passo é importar a popuçação dos municípios brasileiros 
populacao_municipios <- read_excel("Dados/popESTIMADA.xlsx")

# As cidade selecionadas são: São eles: Itacoatiara, Itapiranga, Silves, São Sebastião,
# Nova Olinda do Norte, Urucará e Urucurituba
cod_cidades_selecionadas <- c(1301902, 1302009, 1303106, 1304005, 1304302, 1304401)


cidades_selecionadas <- populacao_municipios[populacao_municipios$Cod == cod_cidades_selecionadas[1], ]
for (codigo in cod_cidades_selecionadas[2:length(cod_cidades_selecionadas)]) {
  aux <- populacao_municipios[populacao_municipios$Cod == codigo, ]
  cidades_selecionadas <- rbind(cidades_selecionadas, aux)
}

aux = NULL

# De posse da população estimada dos municípios selecionados e dos índices de distribuição das 
# idades, criam-se um data frames apenas com os anos de interesse de vigência do PNE (2014-2024).
# A projeção da população brasielira possui dadosde 2010 a 2050, enquanto a estimativa municipal, 
# possui dados de 2001 a 2020. Portanto, futuramente será necessário estimar a população 
# dos municípios para os anos faltantes. Por padrão, vamos trabalhar com os anos 2014 a 2020.

df_projecoes <- df_projecoes[c(1,6:12)]
indices <- indices[c(1,6:12)] 
cidades_selecionadas <- cidades_selecionadas[ , c(2,14:20)]

write.csv2(indices, "output/indices.csv")
write.csv2(cidades_selecionadas, "output/cidades_selecionadas.csv")

# A partir da população dos municípios e os índices calculados, estima-se a
# distribuição das idades por cidade e ano

cidade <- "Itacoatiara" # Selecionando a cidade de interesse
Ano     <- 6            # Selecionando o ano de intesse

# População da CIDADE & ANO selecionada
pop_cidade <- cidades_selecionadas[cidades_selecionadas$Municipio == cidade, Ano]

# Estimativa das idades da população da ICADE X ANO
estimativa_cidade_idade <- round(as.numeric(pop_cidade)*indices[ , Ano],0)
estimativa_cidade_idade <- cbind(idades, estimativa_cidade_idade)

write.csv2(cidades_selecionadas, "output/cidades_selecionadas.csv")

# Estimativa da população por faixa estária
faixaEtaria0a3  <- sum(estimativa_cidade_idade[1:4, 2])  # denominador do indicador 1B
faixaEtaria4a5  <- sum(estimativa_cidade_idade[5:6, 2])  # denominador do indicador 1A

# write.csv2(faixaEtaria0a3,  "output/faixaEtaria0a3.csv")
# write.csv2(faixaEtaria4a5,  "output/faixaEtaria4a5.csv")

# Importando as matrículas do Norte (Censo escolar)

# 1) Segundo o INEP, O software R, como padrão, trabalha com as bases de dados utilizando a memória RAM do
# computador. Entretanto, o carregamento de bases muito grandes (por exemplo, mais de 1 milhão
# de linhas) utilizando a leitura tradicional (como “read.table” ou “read.csv”) pode sobrecarregar o
# computador, ou mesmo resultar em erro por falta de memória. Dessa forma, para a leitura das
# bases de MATRÍCULAS e DOCENTES, que possuem mais de 10 milhões de linhas (Brasil), faz-se
# necessário o uso de pacotes adicionais. Sugerimos o uso do pacote “ffbase” para trabalhar com
# essas bases, tendo em vista que o mesmo faz uso do disco rígido em detrimento da memória RAM.
# Evidentemente, as bases de ESCOLAS e TURMAS também podem ser carregadas utilizando esse
# pacote, sendo recomendável quando houver necessidade de cruzar informações entre as bases. O
# pacote “ffbase” armazena a base de dados no R como um objeto da classe “ffdf” - diferentemente
# da leitura tradicional, que gera um objeto da classe “data.frame”. O objeto “ffdf” também permite a
# aplicação de algumas funções – não todas – que são utilizadas com objetos da classe “data.frame”
# (por exemplo, “table”, “merge” e ”transform”). Para aplicação de filtros nas bases “ffdf”,
# recomendamos o uso da função “ffwhich” 
# (veja a ajuda da função para maiores informações:
# “?ffwhich”). Além disso, para concatenar as bases de cada região (as bases Docentes e Matrículas                                                                                                            estão separadas por região), uma abaixo da outra, é necessário utilizar a função “ffdfappend” (para
#                                                                                                                                                                                                            mais informações: “?ffdfappend”). Informações adicionais estão disponíveis na ajuda do pacote
# (https://cran.r-project.org/web/packages/ffbase/ffbase.pdf).

# 2) Ainda utilizando o mesmo script, instale o pacote necessário para a manipulação de bases maiores
# (ffbase) copiando e colando os comandos abaixo. Rode os comandos pressionando Ctrl+R.
# install.packages("ffbase", dependencies = TRUE) #Instala o pacote
# require(ffbase) #Carrega o pacote

# install.packages("ffbase", dependencies = TRUE)

# library(ffbase)

# 3) Caso você tenha aberto um novo script, será necessário certificar-se novamente de que o Diretório
# de Trabalho no R corresponde ao local onde estão presentes os arquivos por meio dos mesmos
# comandos já citados anteriormente:
# getwd() #Se o caminho não estiver correto, use a função a seguir para alterá-lo:
# setwd("C:/Usuários/Fulano/Documentos/Arquivos censo") #Exemplo de caminho. Lembre-se de
# usar barra simples (“/”) ou barra invertida dupla (“\\”).

# 4) Para abrir o arquivo “MATRICULA_NORTE.csv”, por exemplo, copie o comando abaixo e cole no
# script. Rode o comando pressionando Ctrl+R. O atributo “first.rows” determina a quantidade de
# linhas utilizadas para que o programa perceba o tipo/categoria das variáveis.
# docentes_se<-read.csv2.ffdf(file="DOCENTES_SUDESTE.csv",sep="|",first.rows=100000)
# É importante que o Pipe ( | ) seja utilizado como delimitador.

# matricula_norte <-read.csv2.ffdf(file="Dados/MATRICULA_NORTE.CSV",
#                                 sep="|",first.rows=1000) # uma amostra da base de dados

# 5) Bases grandes, quando carregadas pela primeira vez, podem demorar alguns minutos para
# concluir o processamento (dependendo das configurações do computador). Sugerimos salvar a
# base no formato ‘ffdf’ para que uma nova carga inicial não seja necessária numa próxima sessão.
# save.ffdf(docentes_se, dir="./docentes_se")

# save.ffdf(matricula_norte, dir=".dados/matricula_norte") 

# 6) Dados salvos no formato ‘ffdf’ podem ser carregados em um outro momento utilizando o comando
# abaixo. O carregamento da base com a função abaixo é praticamente instantâneo.
# load.ffdf(dir="./docentes_se")

# 7) Após esses procedimentos, a base de dados já estará aberta, permitindo sua análise. Para conferir
# se a base foi lida corretamente, é possível visualizar algumas linhas copiando o comando abaixo e
# colando no script. Rode o comando pressionando Ctrl+R. Nesse exemplo, são visualizadas as
# cinco primeiras linhas de cada coluna.
# matricula_noirte[1:5,]

# matricula_norte[1:5,]

# Fonte: Microdados do Censo da Educação Básica 2018 Manual do Usuário INEP

# Outra forma de trabalhar com essas grandes bases é selecionado as variáveis de
# de interesse

# Variávies disponíveis para análise

# - attr(*, "spec")=
#   .. cols(
#     ..   NU_ANO_CENSO = col_double(),
#     ..   ID_ALUNO = col_character(),
#     ..   ID_MATRICULA = col_double(),
#     ..   NU_DIA = col_double(),
#     ..   NU_MES = col_double(),
#     ..   NU_ANO = col_double(),
#     ..   NU_IDADE_REFERENCIA = col_double(),
#     ..   NU_IDADE = col_double(),
#     ..   NU_DURACAO_TURMA = col_double(),
#     ..   NU_DUR_ATIV_COMP_MESMA_REDE = col_double(),
#     ..   NU_DUR_ATIV_COMP_OUTRAS_REDES = col_double(),
#     ..   NU_DUR_AEE_MESMA_REDE = col_double(),
#     ..   NU_DUR_AEE_OUTRAS_REDES = col_double(),
#     ..   NU_DIAS_ATIVIDADE = col_double(),
#     ..   TP_SEXO = col_double(),
#     ..   TP_COR_RACA = col_double(),
#     ..   TP_NACIONALIDADE = col_double(),
#     ..   CO_PAIS_ORIGEM = col_double(),
#     ..   CO_UF_NASC = col_double(),
#     ..   CO_MUNICIPIO_NASC = col_double(),
#     ..   CO_UF_END = col_double(),
#     ..   CO_MUNICIPIO_END = col_double(),
#     ..   TP_ZONA_RESIDENCIAL = col_double(),
#     ..   TP_OUTRO_LOCAL_AULA = col_double(),
#     ..   IN_TRANSPORTE_PUBLICO = col_double(),
#     ..   TP_RESPONSAVEL_TRANSPORTE = col_double(),
#     ..   IN_TRANSP_VANS_KOMBI = col_double(),
#     ..   IN_TRANSP_MICRO_ONIBUS = col_double(),
#     ..   IN_TRANSP_ONIBUS = col_double(),
#     ..   IN_TRANSP_BICICLETA = col_double(),
#     ..   IN_TRANSP_TR_ANIMAL = col_double(),
#     ..   IN_TRANSP_OUTRO_VEICULO = col_double(),
#     ..   IN_TRANSP_EMBAR_ATE5 = col_double(),
#     ..   IN_TRANSP_EMBAR_5A15 = col_double(),
#     ..   IN_TRANSP_EMBAR_15A35 = col_double(),
#     ..   IN_TRANSP_EMBAR_35 = col_double(),
#     ..   IN_TRANSP_TREM_METRO = col_double(),
#     ..   IN_NECESSIDADE_ESPECIAL = col_double(),
#     ..   IN_CEGUEIRA = col_double(),
#     ..   IN_BAIXA_VISAO = col_double(),
#     ..   IN_SURDEZ = col_double(),
#     ..   IN_DEF_AUDITIVA = col_double(),
#     ..   IN_SURDOCEGUEIRA = col_double(),
#     ..   IN_DEF_FISICA = col_double(),
#     ..   IN_DEF_INTELECTUAL = col_double(),
#     ..   IN_DEF_MULTIPLA = col_double(),
#     ..   IN_AUTISMO = col_double(),
#     ..   IN_SINDROME_ASPERGER = col_double(),
#     ..   IN_SINDROME_RETT = col_double(),
#     ..   IN_TRANSTORNO_DI = col_double(),
#     ..   IN_SUPERDOTACAO = col_double(),
#     ..   IN_RECURSO_LEDOR = col_double(),
#     ..   IN_RECURSO_TRANSCRICAO = col_double(),
#     ..   IN_RECURSO_INTERPRETE = col_double(),
#     ..   IN_RECURSO_LIBRAS = col_double(),
#     ..   IN_RECURSO_LABIAL = col_double(),
#     ..   IN_RECURSO_BRAILLE = col_double(),
#     ..   IN_RECURSO_AMPLIADA_16 = col_double(),
#     ..   IN_RECURSO_AMPLIADA_20 = col_double(),
#     ..   IN_RECURSO_AMPLIADA_24 = col_double(),
#     ..   IN_RECURSO_NENHUM = col_double(),
#     ..   TP_INGRESSO_FEDERAIS = col_double(),
#     ..   TP_MEDIACAO_DIDATICO_PEDAGO = col_double(),
#     ..   IN_ESPECIAL_EXCLUSIVA = col_double(),
#     ..   IN_REGULAR = col_double(),
#     ..   IN_EJA = col_double(),
#     ..   IN_PROFISSIONALIZANTE = col_double(),
#     ..   TP_ETAPA_ENSINO = col_double(),
#     ..   ID_TURMA = col_double(),
#     ..   CO_CURSO_EDUC_PROFISSIONAL = col_double(),
#     ..   TP_UNIFICADA = col_double(),
#     ..   TP_TIPO_TURMA = col_double(),
#     ..   CO_ENTIDADE = col_double(),
#     ..   CO_REGIAO = col_double(),
#     ..   CO_MESORREGIAO = col_double(),
#     ..   CO_MICRORREGIAO = col_double(),
#     ..   CO_UF = col_double(),
#     ..   CO_MUNICIPIO = col_double(),
#     ..   CO_DISTRITO = col_double(),
#     ..   TP_DEPENDENCIA = col_double(),
#     ..   TP_LOCALIZACAO = col_double(),
#     ..   TP_CATEGORIA_ESCOLA_PRIVADA = col_double(),
#     ..   IN_CONVENIADA_PP = col_double(),
#     ..   TP_CONVENIO_PODER_PUBLICO = col_double(),
#     ..   IN_MANT_ESCOLA_PRIVADA_EMP = col_double(),
#     ..   IN_MANT_ESCOLA_PRIVADA_ONG = col_double(),
#     ..   IN_MANT_ESCOLA_PRIVADA_SIND = col_double(),
#     ..   IN_MANT_ESCOLA_PRIVADA_SIST_S = col_double(),
#     ..   IN_MANT_ESCOLA_PRIVADA_S_FINS = col_double(),
#     ..   TP_REGULAMENTACAO = col_double(),
#     ..   TP_LOCALIZACAO_DIFERENCIADA = col_double(),
#     ..   IN_EDUCACAO_INDIGENA = col_double()
#     .. )



# A partir dessa base de dados, alguma variáveis serão selecionadas. Para o
# cálculo dos indicadores 1A e 1B da Meta 1 do PNE, precisamos apenas de:


# Importação da base de interesse

MATRICULA_NORTE <- read_delim("Dados/MATRICULA_NORTE.CSV", 
                              "|")
# Para o cálculo dos indicadores 1A e 1B da Meta 1 do PNE, vamos selecionar as
# seguintes variáveis

variaveis_selecionadas <- c("NU_IDADE_REFERENCIA", 
                            "CO_MUNICIPIO_END",
                            "CO_UF_END",
                            "CO_MUNICIPIO_END",
                            "TP_DEPENDENCIA",
                            "TP_ETAPA_ENSINO",
                            "CO_REGIAO",
                            "CO_MESORREGIAO",
                            "CO_UF",
                            "CO_MUNICIPIO",
                            "CO_DISTRITO")

# #MATRICULA_NORTE <- read_delim("Dados/MATRICULA_NORTE.CSV", 
#                               "|", escape_double = FALSE, 
#                               trim_ws = TRUE,
#                               col_names = variaveis_selecionadas)

glimpse(MATRICULA_NORTE)

# Seleção do município para cálculo da matricula da educação infantil

nome_da_cidade_escolhida <- "Itacoatiara"
cod_cidade_escolhida     <- 1301902

filtro_por_cidade <- MATRICULA_NORTE[MATRICULA_NORTE$CO_MUNICIPIO == cod_cidade_escolhida, 
                                     variaveis_selecionadas]

write.csv2(filtro_por_cidade, "output/filtro_por_cidade.csv")

# O Código acima apresenta a base de dados do CENSO ESCOLAR para a cidade de 
# interesse. A partir dessa base, é possível agregar as matrículas por faixa-etária
# e série

# 1 - Educação Infantil - Creche
# 2 - Educação Infantil - Pré-escola

# A seguir, a quantidade de alunos de 0 a 3 anos
qtde_alunos_0a3 <- sum(filtro_por_cidade$TP_ETAPA_ENSINO == 1, na.rm = T)

# Qauntidade de alunos com 4 e 5 anos
qtde_alunos_4a5 <- sum(filtro_por_cidade$TP_ETAPA_ENSINO == 2, na.rm = T)

faixa_etaria <- matrix(c(qtde_alunos_0a3, qtde_alunos_4a5),
                       ncol = 2,
                       byrow = T)


colnames(faixa_etaria) <- c("Alunos de 0 a 3 anos", 
                            "Alunos de 4 a 5 anos")

# Meta 1: Indicador 1B

indicador_1B <- qtde_alunos_0a3/faixaEtaria0a3

mensagem1 <- paste0("O indicador 1B, da Meta 1 do Plano Nacional de Educação do", 
                    " município ", nome_da_cidade_escolhida, ", que mede o percetual", 
                    " de crianças de 0 a 3 anos matriculados",
                    " em creches é de ", round(indicador_1B, 2), ".")

print(mensagem1)

# Meta 1: Indicador 1A
indicador_1A <- qtde_alunos_4a5/faixaEtaria4a5

mensagem2 <- paste0("O indicador 1A, da Meta 1 do Plano Nacional de Educação do", 
                    " município ", nome_da_cidade_escolhida, " que mede o percetual", 
                    " de crianças de 4 a 5 anos matriculados",
                    " em creches é de ", round(indicador_1A, 2), ".")

print(mensagem2)


Meta_1 <- (qtde_alunos_0a3 + qtde_alunos_4a5)/(faixaEtaria0a3  + faixaEtaria4a5)

mensagem3 <- paste0("O município de ", cidade, " alcançou ", 
                    round(Meta_1, 2), " referente à Meta 1 do Plano Nacional de Educação",
                    " no ano de 2018")

print(mensagem3)

####